source bizdistrict
{
    type                    = mysql

    sql_host                = 192.168.20.20
    sql_user                = admin
    sql_pass                = 123456
    sql_db                    = dx16
    sql_port                = 5001
    sql_query_pre            = SET NAMES utf8

    sql_query                = SELECT id,cityId,cityName,cityDistrictID,name from bizdistrict
    sql_attr_uint  = cityId
    sql_attr_uint  = cityDistrictID
    sql_query_info_pre      = SET NAMES utf8
    sql_query_info            = SELECT * FROM bizdistrict WHERE id=$id
}

index bizdistrict
{
    source            = bizdistrict
    path            =  /searchteam/wwwroot/storage/bizdistrict
    docinfo            = extern
    mlock            = 0
    morphology        = none
    min_word_len        = 1
    html_strip                = 0

    charset_dictpath = /usr/local/mmseg3/etc/
    charset_type        = zh_cn.utf-8
}




source place
{
    type                    = mysql

    sql_host                = 192.168.20.20
    sql_user                = admin
    sql_pass                = 123456
    sql_db                    = dx16
    sql_port                = 5001
    #sql_query_pre            = SET NAMES utf8
    sql_query_pre = SET SESSION query_cache_type=OFF
    sql_query_pre = LOCK TABLES place READ
    sql_query                = SELECT id,name,address,radians(latitude) as latitude,radians(longitude) as longitude,cityId,blockIndex,bizdistrict,description,createTime,isRecommend,status from place where id>$start and id<$end
    sql_query_post = UNLOCK TABLES
    sql_query_range = SELECT min(id),max(id) from place   
    sql_range_step = 1000
    sql_attr_uint  = status
    sql_attr_uint  = isRecommend
    sql_attr_float = latitude
    sql_attr_float = longitude
    sql_attr_uint = cityId
    sql_attr_uint = blockIndex
    sql_attr_uint = bizdistrict
    sql_attr_timestamp        = createTime
    sql_ranged_throttle = 0
    sql_query_info_pre      = SET NAMES utf8
    sql_query_info            = SELECT id,name,address,latitude,longitude,cityId,blockIndex,bizdistrict,description,createTime,isRecommend,status FROM place WHERE id=$id
}

index place
{
    source            = place
    path            =  /searchteam/wwwroot/storage/place
    docinfo            = extern
    mlock            = 0
    morphology        = none
    min_word_len        = 1
    html_strip                = 0

    charset_dictpath = /usr/local/mmseg3/etc/
    charset_type        = zh_cn.utf-8
}

source place_delta : place
{
    sql_query_pre = SET NAMES utf8
    sql_query_range = SELECT min(id),max(id) from place where createTime >= DATE_FORMAT(CURDATE(),'%Y-%m-%d 04:00:00') or lastUpdate >=DATE_FORMAT(CURDATE(),'%Y-%m-%d 04:00:00') 
     
}

index place_delta : place
{
    source = place_delta
    path = /searchteam/wwwroot/storage/place_delta
}


source tags
{
    type                    = mysql

    sql_host                = 192.168.20.20
    sql_user                = admin
    sql_pass                = 123456
    sql_db                    = dx16
    sql_port                = 5001
    sql_query_pre            = SET NAMES utf8

    sql_query                = SELECT id,name from tags

    sql_query_info_pre      = SET NAMES utf8
    sql_query_info            = SELECT * FROM tags WHERE id=$id
}

index tags
{
    source            = tags
    path            =  /searchteam/wwwroot/storage/tags
    docinfo            = extern
    mlock            = 0
    morphology        = none
    min_word_len        = 1
    html_strip                = 0

    charset_dictpath = /usr/local/mmseg3/etc/
    charset_type        = zh_cn.utf-8
}



source wordexpand
{
    type                    = mysql

    sql_host                = 192.168.20.20
    sql_user                = admin
    sql_pass                = 123456
    sql_db                    = dx16
    sql_port                = 5001
    #sql_query_pre            = SET NAMES utf8
    sql_query_pre = SET SESSION query_cache_type=OFF
    sql_query_pre = LOCK TABLES place READ
    sql_query                = SELECT id,name,name as tag,cityId from place where id>$start and id<$end and status=1
    sql_query_post = UNLOCK TABLES
    sql_query_range = SELECT min(id),max(id) from place   
    sql_range_step = 1000
    sql_attr_string = tag
    sql_attr_uint = cityId
    sql_ranged_throttle = 0
    sql_query_info_pre      = SET NAMES utf8
    sql_query_info            = SELECT id,name FROM place WHERE id=$id
}

index wordexpand
{
    source            = wordexpand
    path            =  /searchteam/wwwroot/storage/wordexpand
    docinfo            = extern
    mlock            = 0
    morphology        = none
    min_word_len        = 1
    html_strip                = 0
    min_infix_len = 1
    charset_dictpath = /usr/local/mmseg3/etc/
    charset_type        = zh_cn.utf-8
}


indexer
{
    mem_limit            = 512M
}

searchd
{
    listen                  =   9312
    read_timeout        = 5
    max_children        = 30
    max_matches            = 1000
    seamless_rotate        = 0
    preopen_indexes        = 0
    unlink_old            = 1
    pid_file = /searchteam/wwwroot/storage/log/searchd_mysql.pid 
    log = /searchteam/wwwroot/storage/log/searchd_mysql.log
    query_log = /searchteam/wwwroot/storage/log/query_mysql.log
    binlog_path = 
}
